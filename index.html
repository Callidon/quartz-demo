<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="author" content="Thomas Minier">
    <title>Quatz demonstration website</title>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.min.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="node_modules/font-awesome/css/font-awesome.min.css">
    <!-- Main theme -->
    <link rel="stylesheet" href="css/main.css">
  </head>
  <body>
    <div class="container" id="demoApp">
      <div class="row">
        <h1>Quartz demonstration <a href="https://github.com/Callidon/quartz-tpf" target="_blank"><i class="fa fa-github fa-lg" aria-hidden="true"></i></a></h1>
        <p>Parallel SPARQL query processing over replicated Triples Pattern Fragments</p>
      </div>

      <div class="row">

        <!-- Controls -->
        <div class="col-md-6">
          <!-- Servers -->
          <div class="row">
            <h3><i class="fa fa-database" aria-hidden="true"></i> Servers</h3>
            <form class="form">
              <div class="form-group">
                <input v-model="newServer" type="text" class="form-control" id="server-url" placeholder="http://fragments.dbpedia.org/2016-04/en">
              </div>
              <button v-on:click="addServer()" type="button" class="btn btn-primary">
                <span class="glyphicon glyphicon-plus"></span> Add a server
              </button>
              or select a preset
              <select class="form-control preset-select" v-model="currentServersPreset">
                <!-- <option active value='none'>No preset</option> -->
                <option v-for="preset in presets.servers" v-bind:value="preset.id" >{{ preset.text }}</option>
              </select>
            </form>
          </div>

          <!-- Servers list -->
          <div class="row">
            <h4>Registered servers</h4>
            <p v-if="servers.length === 0">No servers registered yet</p>
            <ol>
              <li v-for="(server, index) in servers">
                <a v-bind:class="{ 'text-success': serverGreen(index), 'text-danger': serverRed(index), striked: serverRed(index) }" href="#">{{ server }}</a>
                <button type="button" v-on:click="removeServer(server)" class="close">&times;</button>
              </li>
            </ol>
          </div>

          <div class="row">
            <h3><span class="glyphicon glyphicon-search"></span> Query</h3>
            <form class="form">
              <div class="form-group">
                <textarea v-model="query" class="query form-control" id="sparql-query">{{ query }}</textarea>
              </div>
              Type your own query or select a preset
              <select class="form-control preset-select" v-model="currentQueryPreset">
                <!-- <option active value='none'>No preset</option> -->
                <option v-for="preset in presets.queries" v-bind:value="preset.value">{{ preset.text }}</option>
              </select>
            </form>
          </div>

          <div class="row">
            <h3><span class="glyphicon glyphicon-cog"></span> Execution mode</h3>
            <form class="form">
              <div class="form-group">
                <select v-model="mode" class="form-control">
                  <option value="quartz+pen">Quartz with Peneloop</option>
                  <option value="quartz">Quartz without Peneloop</option>
                  <option value="tpf">Classic TPF</option>
                  <option value="tpf+pen">Classic TPF with Peneloop</option>
                </select>
              </div>
              <button v-on:click="run()" v-bind:class="{ disabled: queryInProgress }" class="btn btn-success" type="button">
                <span class="glyphicon glyphicon-ok"></span> Execute query
              </button>
              <button v-on:click="stop()" v-bind:class="{ hidden: !queryInProgress }" class="btn btn-danger" type="button">
                <span class="glyphicon glyphicon-remove"></span> Stop execution
              </button>
              <i v-if="queryInProgress" class="fa fa-refresh fa-spin fa-1x fa-fw"></i>
            </form>
          </div>
        </div>

        <!-- Results -->
        <div class="col-md-6">
          <h3><span class="glyphicon glyphicon-list"></span> Results</h3>
          <div class="panel panel-default">
            <div class="panel-body">
              <p>
                <strong>Execution time:</strong> {{ time }}
                <strong>Number of results:</strong> {{ results.length }} mappings
              </p>
              <div class="results table-responsive">
                <table v-if="results.length > 0" class="table table-hover">
                  <tr>
                    <th v-for="key in vars" class="text-center">{{ key }}</th>
                  </tr>
                  <tr v-for="mappings in results">
                    <td v-for="(value, key) in mappings">
                      {{ value }}
                    </td>
                  </tr>
                </table>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>

    <!-- Load balancing plot -->
    <div class="container">
      <div class="row">
        <h3>
          <span class="glyphicon glyphicon-import"></span> Load balancing</h3>
        <canvas id="httpCalls"></canvas>
        <br>
      </div>
    </div>

    <div class="footer container text-center">
      <div class="row">
        <p>Copyright 2017 Thomas Minier</p>
      </div>
    </div>

    <!-- JQuery + Bootstrap JS -->
    <script src="node_modules/jquery/dist/jquery.min.js" type="text/javascript"></script>
    <script src="node_modules/bootstrap/dist/js/bootstrap.min.js" type="text/javascript"></script>

    <!-- Quartz client -->
    <script src="node_modules/quartz-tpf/quartz-tpf.bundle.js" type="text/javascript"></script>

    <!-- Vue.js -->
    <script src="node_modules/vue/dist/vue.js" type="text/javascript"></script>

    <!-- Chart.js -->
    <script src="node_modules/chart.js/dist/Chart.bundle.min.js"></script>

    <!-- Website Vue.js application -->
    <script src="js/barchart.js" type="text/javascript"></script>
    <script src="js/app.js" type="text/javascript"></script>
  </body>
</html>
